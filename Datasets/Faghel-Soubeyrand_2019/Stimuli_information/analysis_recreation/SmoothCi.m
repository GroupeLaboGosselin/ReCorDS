function [Sci, h] = SmoothCiConv(ci,sigma)% SMOOTHCI Smoothes a 2D image.%	SmoothCi(ci,sigma) convolves a 2D image (ci) with a 2D Gaussian %	filter of standard deviation equals to sigma pixels.%		E.g.,% 		ci = double(imread('GenderFG.tiff'));% 		Sci = SmoothCi(ci,20);% 		or [Sci, h] = SmoothCi(ci,20); if the smoothing filter is needed% % Requires the ImageProcessing Toolbox.% % See also DEMOSTAT4CI% % The Stat4Ci toolbox is free (http://mapageweb.umontreal.ca/gosselif/random-field.html); if you % use it in your research, please, cite us:% 	Chauvin, A., Worsley, K. J., Schyns, P. G., Arguin, M., & Gosselin, F. (2005). Accurate % 	statistical tests for smooth classification images. Journal of Vision, 5(9), 659-667, % 	http://journalofvision.org/5/9/1/, doi:10.1167/5.9.1.% % Alan Chauvin & Frédéric Gosselin (frederic.gosselin@umontreal.ca), 20/08/2004TNoyau = 6*sigma;h = fspecial('gaussian',ceil(TNoyau),sigma);Sci = filter2(h,ci);